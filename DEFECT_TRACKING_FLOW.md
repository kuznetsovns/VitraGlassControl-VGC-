# –°–∏—Å—Ç–µ–º–∞ –¥–µ—Ñ–µ–∫—Ç–æ–≤–∫–∏ –≤–∏—Ç—Ä–∞–∂–µ–π

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã Supabase

#### 1. `placed_vitrages`
–û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã—Ö –≤–∏—Ç—Ä–∞–∂–µ–π —Å ID –∏ –¥–µ—Ñ–µ–∫—Ç–∞–º–∏.

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:**
- `id` - UUID –≤–∏—Ç—Ä–∞–∂–∞
- `object_id` - —Å–≤—è–∑—å —Å –æ–±—ä–µ–∫—Ç–æ–º —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞
- `floor_plan_id` - —Å–≤—è–∑—å —Å –ø–ª–∞–Ω–æ–º —ç—Ç–∞–∂–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `vitrage_id` - ID —Ç–∏–ø–æ–≤–æ–≥–æ –≤–∏—Ç—Ä–∞–∂–∞
- `vitrage_name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏—Ç—Ä–∞–∂–∞ (–í-01, –í-02)
- `vitrage_data` - –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∏—Ç—Ä–∞–∂–∞ (JSON)
- 8-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–π ID:
  - `id_object` - –æ–±—ä–µ–∫—Ç (–ó–∏–ª18, –ü—Ä–∏–º–∞–≤–µ—Ä–∞14)
  - `id_corpus` - –∫–æ—Ä–ø—É—Å (–ê, –ë, 1, 2)
  - `id_section` - —Å–µ–∫—Ü–∏—è (1, 2, 3)
  - `id_floor` - —ç—Ç–∞–∂ (1, 2, 3)
  - `id_apartment` - –∫–≤–∞—Ä—Ç–∏—Ä–∞ (101, 102, 201)
  - `id_vitrage_number` - –Ω–æ–º–µ—Ä –≤–∏—Ç—Ä–∞–∂–∞ (1, 2, 3)
  - `id_vitrage_name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏—Ç—Ä–∞–∂–∞ (–í1, –û–∫–Ω–æ, –î–≤–µ—Ä—å)
  - `id_vitrage_section` - —Å–µ–∫—Ü–∏—è –≤–∏—Ç—Ä–∞–∂–∞ (A, B, 1)
- `full_id` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª–Ω—ã–π ID
- `segment_defects` - –¥–µ—Ñ–µ–∫—Ç—ã —Å–µ–≥–º–µ–Ω—Ç–æ–≤ (JSONB)
  ```json
  {
    "segment-0-0": {
      "defects": ["–¶–∞—Ä–∞–ø–∏–Ω—ã", "–°–∫–æ–ª—ã"],
      "status": "defective",
      "notes": "–ü—Ä–æ–≤–µ—Ä–∏–ª: –ò–≤–∞–Ω–æ–≤ –ò.–ò., –ü—Ä–æ—Ä–∞–±: –ü–µ—Ç—Ä–æ–≤ –ü.–ü.",
      "checked_at": "2024-01-15",
      "checked_by": "–ò–≤–∞–Ω–æ–≤ –ò.–ò."
    }
  }
  ```
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–µ—Ñ–µ–∫—Ç–æ–≤:
  - `total_defects_count` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ñ–µ–∫—Ç–æ–≤
  - `defective_segments_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ñ–µ–∫—Ç–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
- –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏:
  - `inspection_status` - not_checked | in_progress | checked | approved | rejected
  - `inspection_date` - –¥–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
  - `inspector_name` - –∏–º—è –∏–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞
  - `inspection_notes` - –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã:**
- –ü–æ–¥—Å—á–µ—Ç –¥–µ—Ñ–µ–∫—Ç–æ–≤ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ `segment_defects`
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `updated_at` –ø—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏

#### 2. `defect_types`
–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–∏–ø–æ–≤ –¥–µ—Ñ–µ–∫—Ç–æ–≤.

**–ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–µ—Ñ–µ–∫—Ç—ã:**
- –¶–∞—Ä–∞–ø–∏–Ω—ã (low)
- –°–∫–æ–ª—ã (medium)
- –¢—Ä–µ—â–∏–Ω—ã (critical)
- –ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è (low)
- –î–µ—Ñ–æ—Ä–º–∞—Ü–∏—è (high)
- –†–∞–∑–≥–µ—Ä–º–µ—Ç–∏–∑–∞—Ü–∏—è (critical)
- –ó–∞–ø–æ—Ç–µ–≤–∞–Ω–∏–µ (high)
- –ù–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º–æ–Ω—Ç–∞–∂ (medium)

## –ü–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã

### 1. –†–∞–∑–º–µ—â–µ–Ω–∏–µ –≤–∏—Ç—Ä–∞–∂–∞ –Ω–∞ –ø–ª–∞–Ω–µ —ç—Ç–∞–∂–∞

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `FloorPlanEditor.tsx`

```typescript
// –ü—Ä–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ –≤–∏—Ç—Ä–∞–∂–∞ –Ω–∞ –ø–ª–∞–Ω–µ
const placedVitrage = {
  object_id: selectedObject.id,
  floor_plan_id: currentPlan.id,
  vitrage_id: vitrage.id,
  vitrage_name: vitrage.name,
  vitrage_data: vitrage,
  position_x: x,
  position_y: y,
  rotation: 0,
  scale: 1.0
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Supabase
await placedVitrageStorage.create(placedVitrage)
```

### 2. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ ID —Å–µ–∫—Ü–∏—è–º –≤–∏—Ç—Ä–∞–∂–∞

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `FloorPlanEditor.tsx`
**–ö–Ω–æ–ø–∫–∞:** "üÜî –ó–∞–¥–∞—Ç—å ID —Å–µ–∫—Ü–∏–π"

```typescript
// –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è ID
const openVitrageIDDialog = () => {
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ —Å 8 –ø–æ–ª—è–º–∏ –¥–ª—è –≤–≤–æ–¥–∞ ID –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
  setShowVitrageIDDialog(true)
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ ID –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
const saveSegmentID = async (segmentId, idData) => {
  const vitrageIDData = {
    id_object: "–ó–∏–ª18",
    id_corpus: "–ö–æ—Ä–ø—É—Å–ê",
    id_section: "–°–µ–∫—Ü–∏—è1",
    id_floor: "2",
    id_apartment: "101",
    id_vitrage_number: "1",
    id_vitrage_name: "–í",
    id_vitrage_section: "01"
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ Supabase
  await placedVitrageStorage.updateVitrageId(
    placedVitrageId,
    vitrageIDData
  )

  // Full ID –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: "–ó–∏–ª18-–ö–æ—Ä–ø—É—Å–ê-–°–µ–∫—Ü–∏—è1-2-101-1-–í-01"
}
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–æ–≤–∫–∏

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `FloorPlanEditor.tsx`
**–ö–Ω–æ–ø–∫–∞:** "üìã –°–æ–∑–¥–∞—Ç—å –¥–µ—Ñ–µ–∫—Ç–æ–≤–∫—É"

**–£—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:**
- –í—Å–µ —Å–µ–≥–º–µ–Ω—Ç—ã –≤–∏—Ç—Ä–∞–∂–∞ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ ID
- –ö–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å: "(ID: 5/10)" –µ—Å–ª–∏ –Ω–µ –≤—Å–µ ID –Ω–∞–∑–Ω–∞—á–µ–Ω—ã

```typescript
const openDefectTracking = () => {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤—Å–µ —Å–µ–≥–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç ID
  const totalSegments = vitrage.rows * vitrage.cols
  const assignedSegments = placedVitrage.segmentIDs ? Object.keys(placedVitrage.segmentIDs).length : 0

  if (assignedSegments < totalSegments) {
    alert('‚ö†Ô∏è –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å ID –¥–ª—è –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π –≤–∏—Ç—Ä–∞–∂–∞!')
    return
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SVG —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ ID —Å–µ–≥–º–µ–Ω—Ç–æ–≤
  const svgDrawing = generateSimpleSVG(vitrage, placedVitrage.segmentIDs)

  // –û—Ç–∫—Ä—ã—Ç–∏–µ DefectWorkspace
  setSelectedVitrageForDefect(vitrageItem)
}
```

### 4. –†–∞–±–æ—Ç–∞ —Å –¥–µ—Ñ–µ–∫—Ç–∞–º–∏ –≤ DefectWorkspace

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `DefectWorkspace.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤–∏—Ç—Ä–∞–∂–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ ID —Å–µ–≥–º–µ–Ω—Ç–æ–≤
- –ö–ª–∏–∫ –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç DefectPanel
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–æ–≤ –∫–∞–∂–¥–æ–º—É —Å–µ–≥–º–µ–Ω—Ç—É
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Supabase

```typescript
const saveSegmentData = async (vitrageId, segmentId, data) => {
  // –î–∞–Ω–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç–∞
  const segmentData = {
    inspectionDate: "2024-01-15",
    inspector: "–ò–≤–∞–Ω–æ–≤ –ò.–ò.",
    siteManager: "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.",
    defects: ["–¶–∞—Ä–∞–ø–∏–Ω—ã", "–°–∫–æ–ª—ã"]
  }

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ placed_vitrages.segment_defects
  await placedVitrageStorage.updateSegmentDefects(
    placedVitrageId,
    {
      "segment-0-0": {
        defects: ["–¶–∞—Ä–∞–ø–∏–Ω—ã", "–°–∫–æ–ª—ã"],
        status: "defective",
        notes: "–ü—Ä–æ–≤–µ—Ä–∏–ª: –ò–≤–∞–Ω–æ–≤ –ò.–ò., –ü—Ä–æ—Ä–∞–±: –ü–µ—Ç—Ä–æ–≤ –ü.–ü.",
        checked_at: "2024-01-15",
        checked_by: "–ò–≤–∞–Ω–æ–≤ –ò.–ò."
      }
    }
  )

  // –¢—Ä–∏–≥–≥–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—á–µ—Ç—á–∏–∫–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤
}
```

### 5. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ –≤–∫–ª–∞–¥–∫–µ "–î–µ—Ñ–µ–∫—Ç–æ–≤–∫–∞"

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `DefectTracking.tsx`
**–•—É–∫:** `useDefectData.ts`

```typescript
// –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏—Ç—Ä–∞–∂–µ–π —Å –¥–µ—Ñ–µ–∫—Ç–∞–º–∏
const loadVitrages = async () => {
  // –ú–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¢–û–õ–¨–ö–û –≤–∏—Ç—Ä–∞–∂–∏ —Å –¥–µ—Ñ–µ–∫—Ç–∞–º–∏
  const { data } = await placedVitrageStorage.getForDefectTracking(objectId)

  // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è: –≤–∏—Ç—Ä–∞–∂–∏ –≥–¥–µ total_defects_count > 0
  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –≤–∏–¥–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–∞–∫ –≤ "–¢–∏–ø–æ–≤—ã—Ö –≤–∏—Ç—Ä–∞–∂–∞—Ö"
}
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∏—Ç—Ä–∞–∂–∞ –≤ –¥–µ—Ñ–µ–∫—Ç–æ–≤–∫–µ:**
1. –í–∏—Ç—Ä–∞–∂ —Ä–∞–∑–º–µ—â–µ–Ω –Ω–∞ –ø–ª–∞–Ω–µ —ç—Ç–∞–∂–∞
2. –í—Å–µ–º —Å–µ–≥–º–µ–Ω—Ç–∞–º –Ω–∞–∑–Ω–∞—á–µ–Ω—ã ID
3. –•–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–µ–≥–º–µ–Ω—Ç –∏–º–µ–µ—Ç –¥–µ—Ñ–µ–∫—Ç—ã (`total_defects_count > 0`)

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
- –ö–∞—Ä—Ç–æ—á–∫–∏ –≤–∏—Ç—Ä–∞–∂–µ–π (–∫–∞–∫ –≤ "–¢–∏–ø–æ–≤—ã–µ –≤–∏—Ç—Ä–∞–∂–∏")
- –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏—Ç—Ä–∞–∂–∞ —Å –ø–æ–ª–Ω—ã–º ID
- –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ñ–µ–∫—Ç–æ–≤
- –ö–ª–∏–∫ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç DefectWorkspace –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –°–µ—Ä–≤–∏—Å—ã

### placedVitrageStorage

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

```typescript
// –ü–æ–ª—É—á–∏—Ç—å –≤–∏—Ç—Ä–∞–∂–∏ —Å –¥–µ—Ñ–µ–∫—Ç–∞–º–∏ –¥–ª—è –æ–±—ä–µ–∫—Ç–∞
getForDefectTracking(objectId: string)

// –°–æ–∑–¥–∞—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã–π –≤–∏—Ç—Ä–∞–∂
create(vitrageData: PlacedVitrageData)

// –û–±–Ω–æ–≤–∏—Ç—å ID —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
updateVitrageId(vitrageId: string, idData: Partial<PlacedVitrageData>)

// –û–±–Ω–æ–≤–∏—Ç—å –¥–µ—Ñ–µ–∫—Ç—ã —Å–µ–≥–º–µ–Ω—Ç–æ–≤
updateSegmentDefects(vitrageId: string, segmentDefects: Record<string, SegmentDefect>)

// –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏
updateInspectionStatus(vitrageId: string, status: string, inspector?: string, notes?: string)

// –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –¥–µ—Ñ–µ–∫—Ç–∞–º
getDefectsStatistics(objectId: string)
```

### defectStorage

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

```typescript
// –ü–æ–ª—É—á–∏—Ç—å —Ç–∏–ø—ã –¥–µ—Ñ–µ–∫—Ç–æ–≤
getDefectTypes()

// –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø –¥–µ—Ñ–µ–∫—Ç–∞
addDefectType(name: string)

// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–µ—Ñ–µ–∫—Ç—ã —Å–µ–≥–º–µ–Ω—Ç–∞
saveSegmentDefects(vitrageId: string, segmentIndex: number, data: SegmentDefectData)

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–µ—Ñ–µ–∫—Ç—ã
getAll()
```

## –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `DefectListView.tsx`
**–•—É–∫:** `useDefectExport.ts`

**–§–æ—Ä–º–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∞:**
1. üìã –í—Å–µ –≤–∏—Ç—Ä–∞–∂–∏
2. ‚ö†Ô∏è –¢–æ–ª—å–∫–æ —Å –¥–µ—Ñ–µ–∫—Ç–∞–º–∏
3. üìÑ –í—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∏—Ç—Ä–∞–∂

**–§–æ—Ä–º–∞—Ç Excel:**
- –õ–∏—Å—Ç "–°–≤–æ–¥–∫–∞" - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –õ–∏—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∏—Ç—Ä–∞–∂–∞ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º

## Fallback –Ω–∞ localStorage

–í—Å–µ –º–µ—Ç–æ–¥—ã `placedVitrageStorage` –∏–º–µ—é—Ç fallback –Ω–∞ localStorage:
- –ï—Å–ª–∏ Supabase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Supabase
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö: ‚òÅÔ∏è (Supabase) –∏–ª–∏ üì¶ (localStorage)

## –ú–∏–≥—Ä–∞—Ü–∏–∏

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

1. `007_create_placed_vitrages_table.sql` - —Ç–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã—Ö –≤–∏—Ç—Ä–∞–∂–µ–π
2. `008_create_vitrage_segment_ids_table.sql` - —Ç–∞–±–ª–∏—Ü–∞ ID —Å–µ–≥–º–µ–Ω—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é —Å–º. –≤ `SUPABASE_SETUP.md`

## –¢–∏–ø—ã TypeScript

–í—Å–µ —Ç–∏–ø—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤:
- `src/types/database.ts` - —Ç–∏–ø—ã –¥–ª—è Supabase
- `src/services/placedVitrageStorage.ts` - —Ç–∏–ø—ã –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã—Ö –≤–∏—Ç—Ä–∞–∂–µ–π
- `src/components/DefectTracking/types.ts` - —Ç–∏–ø—ã –¥–ª—è –¥–µ—Ñ–µ–∫—Ç–æ–≤–∫–∏

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤
‚úÖ –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ ID —Å 8 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ fallback –Ω–∞ localStorage
‚úÖ –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ `updated_at`
‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel
‚úÖ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
